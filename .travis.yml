---
dist: bionic
language: generic
env:
    global:
        - CONTAINER_CMD=docker
        - customize=""
    matrix:
        - CONTAINER_IMAGE=quay.io/ovirt/vdsm-test-func-network-centos-8
          testflags="--test-vdsm"

matrix:
    fast_finish: true
    allow_failures:
        - env: CONTAINER_IMAGE=quay.io/ovirt/vdsm-test-func-network-centos-8
               testflags="--test-vdsm"

addons:
    apt:
        packages:
            - git
            - gnupg2
            - openssh-client
            - python-tox
            - xz-utils

services:
    - docker

script:
    - sudo modprobe openvswitch
    - sudo ./automation/run-tests.sh $testflags --customize="${customize}"

after_failure:
    - sudo ./automation/upload_test_artifacts.sh
